#!/usr/bin/env zsh

# Place Retina internal display (eDP*) below external monitor (HDMI)

SCALE=1.6

EXT=`xrandr --current | sed 's/^\(.*\) connected.*$/\1/p;d' | grep -v ^eDP | head -n 1`
INT=`xrandr --current | sed 's/^\(.*\) connected.*$/\1/p;d' | grep -v ^HDMI | head -n 1`

ext_w=`xrandr | sed 's/^'"${EXT}"' [^0-9]* \([0-9]\+\)x.*$/\1/p;d'`
ext_h=`xrandr | sed 's/^'"${EXT}"' [^0-9]* [0-9]\+x\([0-9]\+\).*$/\1/p;d'`
int_w=`xrandr | sed 's/^'"${INT}"' [^0-9]* \([0-9]\+\)x.*$/\1/p;d'`
off_w=`echo $(( ($int_w-$ext_w)/2 )) | sed 's/^-//'`
x=$(( $SCALE*$off_w ))
y=$(( $SCALE*$ext_h ))

xrandr --output "${INT}" --auto --pos ${x%.*}x${y%.*} --output "${EXT}" --auto --scale ${SCALE}x${SCALE} --pos 0x0
